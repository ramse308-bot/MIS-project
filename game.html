<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cubic Rhythm Game - Auto-scrolling platformer">
    <title>Cubic Rhythm - Mikail Ramsey</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="CSS/style.css"> 
    
    <style>
        /* --- Embedded Game Styles --- */
        :root {
            /* Defining variables here to ensure they exist even if external CSS fails */
            --bg: #0f1720; 
            --surface: #1e293b; 
            --accent: #7dd3fc; 
            --text: #f1f5f9; 
            --muted: #94a3b8; 
            --radius: 8px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 32px;
        }

        body {
            margin: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Inter', sans-serif;
        }

        .game-page {
            min-height: 100vh;
            padding-top: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            margin-bottom: var(--spacing-md);
            color: var(--text);
        }

        .game-container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--surface);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
        }

        #gameCanvas {
            display: block;
            width: 100%;
            height: 600px;
            background: #1a1a1a; /* Ensures canvas is dark, not white */
            cursor: pointer;
            user-select: none;
        }

        .start-screen, .game-over-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            background: rgba(15, 23, 32, 0.95);
            padding: var(--spacing-lg);
            border-radius: var(--radius);
            border: 2px solid var(--accent);
            z-index: 20;
            width: 90%;
            max-width: 400px;
            backdrop-filter: blur(5px);
            display: flex; /* Flex to center content */
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .start-screen h1 {
            color: #00ff00;
            font-size: 2.5em;
            margin: 0 0 10px 0;
            text-shadow: 0 0 15px #00ff00;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }

        .start-screen h2 {
            color: #00ffff;
            font-size: 1.2em;
            margin: 0 0 20px 0;
            font-family: 'Courier New', monospace;
        }

        .start-screen p, .game-over-screen p {
            color: var(--muted);
            margin: 5px 0;
            font-family: 'Inter', sans-serif;
        }

        .start-btn, .restart-btn {
            background: #ffffff;
            color: #000;
            border: none;
            padding: 12px 30px;
            font-size: 1.2em;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            cursor: pointer;
            border-radius: 4px;
            margin-top: 20px;
            text-transform: uppercase;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }

        .start-btn:hover, .restart-btn:hover {
            background: #e0e0e0;
            transform: scale(1.05);
        }

        .game-over-screen {
            display: none; /* Hidden by default */
        }

        .game-over-screen h2 {
            color: #ff4444;
            font-size: 2.5em;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
        }

        #finalScore {
            color: white;
            font-size: 1.5em;
        }

        #newHighScore {
            color: #00ff00;
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 10px;
            display: none;
        }

        .game-info {
            padding: var(--spacing-md);
            background: var(--surface);
            color: var(--muted);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        /* Navigation Styles (Simplified for this file) */
        nav {
            background: rgba(15, 23, 32, 0.9);
            backdrop-filter: blur(10px);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 100;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }
        .nav-logo { color: white; text-decoration: none; font-weight: bold; font-size: 1.2rem; }
        .nav-links { display: flex; gap: 2rem; list-style: none; padding: 0; margin: 0; }
        .nav-links a { color: var(--muted); text-decoration: none; transition: 0.3s; }
        .nav-links a:hover, .nav-links a.active { color: var(--accent); }

        @media (max-width: 768px) {
            .nav-links { display: none; } /* Hiding nav on mobile for simplicity in this fix */
            #gameCanvas { height: 400px; }
            .start-screen h1 { font-size: 1.8em; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="nav-container">
            <a href="Index.html" class="nav-logo">Mikail Ramsey</a>
            <ul class="nav-links">
                <li><a href="Index.html">Home</a></li>
                <li><a href="hobbies.html">Hobbies</a></li>
                <li><a href="discover.html">Discover</a></li>
                <li><a href="resume.html">Resume</a></li>
                <li><a href="career.html">Career</a></li>
                <li><a href="game.html" class="active">Game</a></li>
            </ul>
        </div>
    </nav>

    <div class="game-page">
        <div class="container">
            <h1 class="section-title">Cubic Rhythm</h1>
            <p style="text-align: center; color: var(--muted); margin-bottom: 30px;">
                Navigate obstacles to the beat. Tap or Space to jump.
            </p>

            <div class="game-container">
                <canvas id="gameCanvas"></canvas>
                
                <div class="start-screen" id="startScreen">
                    <h1>CUBIC RHYTHM</h1>
                    <h2>GEOMETRY STYLE</h2>
                    <p>SPACEBAR or CLICK to jump</p>
                    <p>Hold for higher jump!</p>
                    <button class="start-btn" id="startButton" type="button">START GAME</button>
                </div>

                <div class="game-over-screen" id="gameOverScreen">
                    <h2>GAME OVER</h2>
                    <p id="finalScore">Score: 0</p>
                    <p id="newHighScore">NEW HIGH SCORE!</p>
                    <button class="restart-btn" id="restartButton" type="button">TRY AGAIN</button>
                </div>
            </div>

            <div class="game-info">
                <h3>How to Play</h3>
                <p>The world scrolls automatically. Press Spacebar or Click to jump over spikes and blocks. Hold the button longer to jump higher.</p>
            </div>
        </div>
    </div>

    <footer style="text-align: center; padding: 20px; color: var(--muted); font-size: 0.9em;">
        <p>&copy; 2024 Mikail Ramsey. All rights reserved.</p>
    </footer>

    <script>
        // Get DOM Elements
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const startButton = document.getElementById('startButton');
        const restartButton = document.getElementById('restartButton');
        const finalScoreText = document.getElementById('finalScore');
        const newHighScoreText = document.getElementById('newHighScore');

        // Audio Setup
        // Note: If these files are missing, the game will still work, but check console for errors.
        const jumpSound = new Audio('sounds/jump.mp3');
        const gameMusic = new Audio('sounds/gamesound.mp3');
        gameMusic.loop = true;
        gameMusic.volume = 0.5;

        // Game Constants
        const GAME_WIDTH = 1200;
        const GAME_HEIGHT = 600;
        const GROUND_Y = GAME_HEIGHT - 60;
        const SCROLL_SPEED = 7;

        // Setup Canvas Resolution
        canvas.width = GAME_WIDTH;
        canvas.height = GAME_HEIGHT;

        // Game Variables
        let gameState = 'start'; // start, playing, gameOver
        let animationFrameId;
        let score = 0;
        let highScore = localStorage.getItem('cubicHighScore') || 0;
        let obstacles = [];
        let lastObstacleTime = 0;
        
        // Player Object
        const player = {
            x: 100,
            y: GROUND_Y - 50,
            size: 50,
            color: '#7dd3fc',
            velocityY: 0,
            gravity: 0.6,
            jumpStrength: -13,
            isJumping: false,
            isGrounded: true,
            rotation: 0,
            jumpDuration: 0,
            maxJumpDuration: 12
        };

        // Classes
        class Spike {
            constructor(x) {
                this.x = x;
                this.y = GROUND_Y - 40;
                this.width = 40;
                this.height = 40;
                this.color = '#ff0000';
            }
            update() { this.x -= SCROLL_SPEED; }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.moveTo(this.x, this.y + this.height);
                ctx.lineTo(this.x + this.width / 2, this.y);
                ctx.lineTo(this.x + this.width, this.y + this.height);
                ctx.fill();
            }
            getBounds() {
                return { x: this.x + 10, y: this.y + 10, width: this.width - 20, height: this.height - 10 };
            }
        }

        class Block {
            constructor(x, width, height) {
                this.x = x;
                this.y = GROUND_Y - height;
                this.width = width;
                this.height = height;
                this.color = '#545454';
            }
            update() { this.x -= SCROLL_SPEED; }
            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
                // Border
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                ctx.strokeRect(this.x, this.y, this.width, this.height);
            }
            getBounds() {
                return { x: this.x, y: this.y, width: this.width, height: this.height };
            }
        }

        // --- FUNCTIONS ---

        function initGame() {
            // Reset Player
            player.y = GROUND_Y - player.size;
            player.velocityY = 0;
            player.rotation = 0;
            player.isGrounded = true;
            
            // Reset Game World
            obstacles = [];
            score = 0;
            gameState = 'playing';
            
            // Create Initial Obstacles
            generateObstacle(800);
            generateObstacle(1200);
            
            // UI
            startScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            
            // Audio
            try {
                gameMusic.currentTime = 0;
                gameMusic.play();
            } catch(e) { console.log("Audio play failed (user interaction needed)"); }

            // Start Loop
            if (animationFrameId) cancelAnimationFrame(animationFrameId);
            gameLoop();
        }

        function generateObstacle(xOffset) {
            const type = Math.random();
            let obs;
            
            if (type < 0.5) {
                // Spike
                obs = new Spike(xOffset);
            } else if (type < 0.8) {
                // Small Block
                obs = new Block(xOffset, 50, 50);
            } else {
                // Tall Block
                obs = new Block(xOffset, 50, 90);
            }
            obstacles.push(obs);
        }

        function update() {
            // Player Physics
            if (!player.isGrounded) {
                player.velocityY += player.gravity;
                player.y += player.velocityY;
                player.rotation += 0.1; // Rotate while jumping
            } else {
                // Snap rotation when grounded
                player.rotation = Math.round(player.rotation / (Math.PI/2)) * (Math.PI/2);
            }

            // Ground Collision
            if (player.y >= GROUND_Y - player.size) {
                player.y = GROUND_Y - player.size;
                player.isGrounded = true;
                player.velocityY = 0;
            } else {
                player.isGrounded = false;
            }

            // Variable Jump Height
            if (player.isJumping && player.jumpDuration < player.maxJumpDuration) {
                player.velocityY -= 0.5;
                player.jumpDuration++;
            }

            // Obstacles
            if (Date.now() - lastObstacleTime > 1200 + Math.random() * 1000) {
                generateObstacle(GAME_WIDTH + 100);
                lastObstacleTime = Date.now();
            }

            obstacles.forEach(obs => obs.update());
            
            // Cleanup off-screen obstacles
            obstacles = obstacles.filter(obs => obs.x + obs.width > -100);

            // Collision Detection
            checkCollisions();

            // Score
            score++;
        }

        function checkCollisions() {
            const pRect = {
                x: player.x + 10, // slight hitbox padding
                y: player.y + 10,
                width: player.size - 20,
                height: player.size - 20
            };

            obstacles.forEach(obs => {
                const oRect = obs.getBounds();
                if (pRect.x < oRect.x + oRect.width &&
                    pRect.x + pRect.width > oRect.x &&
                    pRect.y < oRect.y + oRect.height &&
                    pRect.y + pRect.height > oRect.y) {
                    gameOver();
                }
            });
        }

        function draw() {
            // Clear Screen
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT);

            // Draw Ground
            ctx.fillStyle = '#222222';
            ctx.fillRect(0, GROUND_Y, GAME_WIDTH, GAME_HEIGHT - GROUND_Y);
            ctx.strokeStyle = '#7dd3fc';
            ctx.beginPath();
            ctx.moveTo(0, GROUND_Y);
            ctx.lineTo(GAME_WIDTH, GROUND_Y);
            ctx.stroke();

            // Draw Player
            ctx.save();
            ctx.translate(player.x + player.size/2, player.y + player.size/2);
            ctx.rotate(player.rotation);
            ctx.fillStyle = player.color;
            ctx.fillRect(-player.size/2, -player.size/2, player.size, player.size);
            // Player Inner Border
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.strokeRect(-player.size/2, -player.size/2, player.size, player.size);
            ctx.restore();

            // Draw Obstacles
            obstacles.forEach(obs => obs.draw());

            // Draw Score
            ctx.fillStyle = 'white';
            ctx.font = '20px Courier New';
            ctx.fillText(`SCORE: ${Math.floor(score/10)}`, 20, 40);
        }

        function gameOver() {
            gameState = 'gameOver';
            cancelAnimationFrame(animationFrameId);
            gameMusic.pause();
            
            // Update UI
            gameOverScreen.style.display = 'flex';
            finalScoreText.innerText = `SCORE: ${Math.floor(score/10)}`;
            
            if (Math.floor(score/10) > highScore) {
                highScore = Math.floor(score/10);
                localStorage.setItem('cubicHighScore', highScore);
                newHighScoreText.style.display = 'block';
            } else {
                newHighScoreText.style.display = 'none';
            }
        }

        function gameLoop() {
            if (gameState === 'playing') {
                update();
                draw();
                animationFrameId = requestAnimationFrame(gameLoop);
            }
        }

        // Initial Draw (So screen isn't white)
        draw();

        // --- CONTROLS ---
        function jumpStart(e) {
            if (e) e.preventDefault(); // prevent scroll
            
            if (gameState === 'start' || gameState === 'gameOver') {
                // handled by buttons, but spacebar also works
                if (gameState === 'gameOver' && e.code === 'Space') initGame();
                if (gameState === 'start' && e.code === 'Space') initGame();
                return;
            }

            if (player.isGrounded) {
                player.isJumping = true;
                player.isGrounded = false;
                player.velocityY = player.jumpStrength;
                player.jumpDuration = 0;
                
                // Play Sound
                try {
                    jumpSound.currentTime = 0;
                    jumpSound.play();
                } catch(e) {}
            }
        }

        function jumpEnd(e) {
            if (e) e.preventDefault();
            player.isJumping = false;
        }

        // Event Listeners
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space' || e.code === 'ArrowUp') jumpStart(e);
        });
        window.addEventListener('keyup', (e) => {
            if (e.code === 'Space' || e.code === 'ArrowUp') jumpEnd(e);
        });
        
        canvas.addEventListener('mousedown', jumpStart);
        canvas.addEventListener('mouseup', jumpEnd);
        canvas.addEventListener('touchstart', jumpStart, {passive: false});
        canvas.addEventListener('touchend', jumpEnd, {passive: false});

        startButton.addEventListener('click', initGame);
        restartButton.addEventListener('click', initGame);

    </script>
</body>
</html>